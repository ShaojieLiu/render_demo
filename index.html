<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>snapSvg</title>
        <style>
            .ref{
                /*transform-origin: 50% 100%;*/
                transform: scaleY(1)  rotateX(180deg) ;
            }
        </style>
    </head>
    <body>
        <div class="num1-input">
            <span>content: </span>
            <input id="num1-content" name="content" type="text">
            <span>type: </span>
            <input id="num1-type" name="styleType" type="text">
            <span>color: </span>
            <input id="num1-color" name="color" type="text">
            <br>
            <span>fontSize: </span>
            <input id="num1-fontSize" name="fontSize" type="text">
            <span>fontFamily: </span>
            <input id="num1-fontFamily" name="fontFamily" type="text">
            <span>eg: Times New Roman,Georgia,Serif</span>
            <br>

        </div>
        <txt id="num1">
        </txt>

<script src='./lib/snap.svg.js'></script>
<script type="text/javascript">
var e = (sel) => document.querySelector(sel)
var es = (sel) => document.querySelectorAll(sel)
var log = (...args) => console.log(...args)

var txt = function(props) {
    e('#num1').innerHTML += `<svg height="300px" id=${props.eleID}></svg>`
    var svg = e(`#${props.eleID}`)
    var paper = Snap(`#${props.eleID}`),
        styleTypeList = {
            0: {
                shadowOpacity: 0,
                urlMain: './img/t0.jpg',
            },
            1: {

            },
            2: {
                shadowPosition: ['0.0em', '1.0em'],
                shadowBlur: [4, 4],
                shadowOpacity: 1,
                urlMain: "./img/t11.jpg",
                shadowColor: '#55d',
                reflectOpacity: 0.5,
            }
        }


    var defaultStyle = {
        shadowColor: '#555',
        shadowPosition: ['0.04em', '1.04em'],
        shadowBlur: [1, 1],
        shadowOpacity: 0.5,
        bottomColor: '#fff',
        urlMain: "./img/t10.jpg",
        reflectOpacity: 0,
    }

    var style = Object.assign({}, defaultStyle, styleTypeList[props.styleType], props)
    var fontSize = style.fontSize,
        fontFamily = style.fontFamily,
        urlMain = style.urlMain,
        color = style.color

//    log('debug style:\n', style)

    var txtShadow = paper.text(...style.shadowPosition, style.content),
        txtReflect = paper.text(0, '-1.15em', style.content),
        txtBottom = paper.text(0, '1em', style.content),
        txtMain = paper.text(0, '1em', style.content),
        shadowF = paper.filter(Snap.filter.blur(...style.shadowBlur)),
//        shadowF = paper.filter(Snap.filter.shadow(1, 1, 1)),
        url0 = "./img/t0.jpg",
        urlRef = "./img/t11.jpg",
        imgMain = paper.image(urlMain, -10, 0, 500, 300),
        imgShadow = paper.image(url0, 0, 0, 1366, 768),
        imgBlank = paper.image(url0, 0, 0, 1366, 768),
        imgReflect = paper.image(urlRef, -10, -140, 1366, 200)


    var mainOptions = {
        mask: imgMain,
        fill: color,
        fontSize,
        fontFamily,
    },
    bottomOptions = {
        mask: imgBlank,
        fill: style.bottomColor,
    },
    shadowOptions = {
        mask: imgShadow,
        fill: style.shadowColor,
        "fill-opacity": style.shadowOpacity,
        filter: shadowF
    },
    reflectOptions = {
        class: 'ref',
        mask: imgReflect,
        "fill-opacity": style.reflectOpacity,
    }
    log(e(`#${props.eleID} text`))
    shadowOptions = Object.assign({}, mainOptions, shadowOptions)
    bottomOptions = Object.assign({}, mainOptions, bottomOptions)
    reflectOptions = Object.assign({}, mainOptions, reflectOptions)

    txtMain.attr(mainOptions)
    txtBottom.attr(bottomOptions)
    txtReflect.attr(reflectOptions)
    txtShadow.attr(shadowOptions)

    svg.style.width = e(`#${props.eleID} text`).clientWidth
//    svg.style.height = e(`#${props.eleID} text`).clientHeight

//    e('.ref').style = 'transform: rotateX(-60deg)'
}

var defaulOptions = {
    content: '艺术字',
    styleType: 2,
    fontSize: '6em',
    color: '#35f'
}

var render = function(obj) {
    var options = Object.assign({}, defaulOptions, obj)
    e('#num1').innerHTML = ``
    txt(Object.assign({}, options, {eleID: 'num1-txt1',styleType: 0}))
    txt(Object.assign({}, options, {eleID: 'num1-txt2',styleType: 1}))
    txt(Object.assign({}, options, {eleID: 'num1-txt3',styleType: 2}))
}

var bindAll = function() {
    var ele = e('.num1-input')
    ele.addEventListener('input', function() {
        var obj = {}
        es('.num1-input input').forEach((ele) => {
            if ('' !== ele.value) {
                obj[ele.name] = ele.value
            }
        })
        render(obj)
    })
}

var __main = function() {
    render({})
    bindAll()

}

__main()

</script>
    </body>
</html>
